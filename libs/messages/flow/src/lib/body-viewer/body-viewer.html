<div class="editor-container">
  <div class="actions">
    <h2 class="title">{{header()}}</h2>
    <p-toggle-switch
      [(ngModel)]="showPrettyBody"
      pTooltip="Show pretty body"
      tooltipPosition="bottom"
      [disabled]="!prettyPrintAvailable()"
    />
    <p-button
      icon="pi pi-window-maximize"
      (click)="displayBodyFullscreen.set(true)"
      [rounded]="true"
      [text]="true"
    ></p-button>
  </div>
  <div class="editor">
    <ng-container *ngTemplateOutlet="bodyView"/>
  </div>
</div>

<p-dialog
  header="Message body"
  appendTo="body"
  [(visible)]="displayBodyFullscreen"
  [modal]="true"
  [style]="{ width: '100%', height: '100%' }"
>
  <div class="editor-container">
    <div class="actions">
      <p-toggle-switch
        [(ngModel)]="showPrettyBody"
        pTooltip="Show pretty body"
        tooltipPosition="bottom"
        [disabled]="!prettyPrintAvailable()"
      />
    </div>
    @if (displayBodyFullscreen()) {
      <div class="editor">
        <ng-container *ngTemplateOutlet="bodyView"/>
      </div>
    }
  </div>
</p-dialog>

<ng-template #bodyView>
  @if (isCsvTableVisible()) {
    <div class="csv-table-wrapper">
      <p-table [value]="csvRows()" [scrollable]="true" scrollHeight="flex">
        <ng-template pTemplate="header">
          <tr>
            @for (header of csvHeaders(); track header) {
              <th>{{ header }}</th>
            }
          </tr>
        </ng-template>

        <ng-template pTemplate="body" let-rowData>
          <tr>
            @for (header of csvHeaders(); track header) {
              <td>{{ rowData[header] }}</td>
            }
          </tr>
        </ng-template>
      </p-table>
    </div>
  } @else {
    @let body = shownBody();
    @if (body !== undefined) {
      <sbb-editor
        [editorOptions]="editorOptions()"
        [value]="body"
      ></sbb-editor>
    }
  }
</ng-template>
